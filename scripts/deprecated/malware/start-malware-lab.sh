#!/bin/bash

echo "╔══════════════════════════════════════════════════════════════╗"
echo "║              MALWARE ANALYSIS LAB - ISOLATED MODE            ║"
echo "╚══════════════════════════════════════════════════════════════╝"
echo ""
echo "⚠️  WARNING: This starts an ISOLATED malware analysis environment"
echo "⚠️  Network access is DISABLED for safety"
echo ""

read -p "Do you want to continue? (yes/no): " response
if [[ ! "$response" =~ ^([yY][eE][sS])$ ]]; then
    echo "Aborted."
    exit 1
fi

echo ""
echo "[*] Creating malware analysis directories..."
mkdir -p malware-samples malware-reports

echo "[*] Pulling latest Kali Linux base image..."
docker pull kalilinux/kali-rolling:latest

echo "[*] Building Docker image..."
docker-compose -f docker-compose.malware.yml build

echo "[*] Starting isolated malware analysis container..."
docker-compose -f docker-compose.malware.yml up -d kali-malware

echo ""
echo "═══════════════════════════════════════════════════════════════"
echo "  Malware Analysis Lab is now running!"
echo "═══════════════════════════════════════════════════════════════"
echo ""
echo "Access methods:"
echo "  • CLI: docker exec -it kali-malware-isolated /bin/bash"
echo "  • GUI: ./scripts/run-gui.sh firefox (requires XQuartz)"
echo ""
echo "Important notes:"
echo "  • Network is DISABLED for safety"
echo "  • Place samples in ./malware-samples/"
echo "  • Reports will be saved to ./malware-reports/"
echo "  • Run setup: docker exec -it kali-malware-isolated /home/kali/scripts/setup-malware-analysis.sh"
echo ""
echo "To stop: docker-compose -f docker-compose.malware.yml down"
echo ""
echo "⚠️  REMEMBER: Never run malware on your host system!"